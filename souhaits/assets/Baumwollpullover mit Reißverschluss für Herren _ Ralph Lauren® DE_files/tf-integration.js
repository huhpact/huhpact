(()=>{"use strict";var e,t;const n="undefined"!=typeof self?self:globalThis,i=null!==(e=n.window)&&void 0!==e?e:{},r=null!==(t=n.document)&&void 0!==t?t:{},o={NODE_ENV:"production",PUBLIC_URL:void 0,WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,TFP_APP_DIST_PUBLIC_URL:"/consumer-ux/7.0-localized-202502201542.77/tfp-app",TF_INTEGRATION_UX_VERSION:"7.0-localized-202502201542.77"};var a,c,s,d,l,f,u,p,g,h,m,y;function v(e){if(""===(e=e||r.location.hostname)||"localhost"===e)return;const t=/(^[^.]+$)|([^.]+\.((?:com|net|org|[^.]{2})\.)?(?:[^.]+|vercel\.app|myshopify\.com|webflow\.io)\.?$)/.exec(e);if(t)return t[0];console.error("Could not parse parent domain from domain "+e)}function b(){return(new Date).getTime()}function w(e){const{name:t,value:n,domain:i,sameSite:o}=e;let{maxAge:a}=e,c=`${t}=${n}`;i&&(c+=`;domain=${i}`),c+=";path=/",null!=a&&(a<0&&(a=0),c+=`;max-age=${a.toFixed()}`),c+=";secure",c+=o?`;samesite=${o}`:";samesite=strict",r.cookie=c}function E(e){var t;return null===(t=r.cookie.split(";").find((t=>t.trim().startsWith(`${e}=`))))||void 0===t?void 0:t.split("=")[1]}function I(e){let t=0;return r.cookie.split(";").forEach((n=>{n.trim().startsWith(`${e}=`)&&t++})),t}!function(e){e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR"}(a||(a={})),function(e){e[e.TRACE=1]="TRACE",e[e.DEBUG=2]="DEBUG",e[e.INFO=3]="INFO",e[e.WARN=4]="WARN",e[e.ERROR=5]="ERROR",e[e.OFF=6]="OFF"}(c||(c={})),function(e){e.Female="Female",e.Male="Male",e.Unisex="Unisex"}(s||(s={})),function(e){e.Adult="Adult",e.Child="Child"}(d||(d={})),function(e){e.YrMo="YrMo"}(l||(l={})),function(e){e.Cm="Cm",e.FtIn="FtIn"}(f||(f={})),function(e){e.Kg="Kg",e.Lb="Lb",e.StLb="StLb"}(u||(u={})),function(e){e.Cm="Cm",e.In="In"}(p||(p={})),function(e){e.ExtraLong="ExtraLong",e.Long="Long",e.Regular="Regular",e.Short="Short"}(g||(g={})),function(e){e.WayTooShort="WayTooShort",e.TooShort="TooShort",e.JustRight="JustRight",e.TooLong="TooLong",e.WayTooLong="WayTooLong"}(h||(h={})),(y=m||(m={})).Snug="Snug",y.GreatFitSnug="GreatFitSnug",y.GreatFit="GreatFit",y.GreatFitLoose="GreatFitLoose",y.Loose="Loose";const O="tfc-l";function T(e,t){R("k",e,t)}function $(){return A("k")}function k(){if(E(O))return!0;R("t","x",3600);const e="x"===A("t");return e&&F("t"),e}function x(){const e=E(O);return e?JSON.parse(decodeURIComponent(e)):{}}function S(e){const t=encodeURIComponent(JSON.stringify(e)),{cookieSameSiteNone:n}=wt(),i=v();w({name:O,value:t,domain:i,maxAge:31536e4,sameSite:n?"none":"strict"}),I(O)>1&&function(e){const t=v(e=e||r.location.hostname);if(null==t)return[];{let n=[];e!==t&&(n=e.substring(0,e.lastIndexOf(t)-1).split("."));let i=t;const r=[i];return n.reverse().forEach((e=>{r.push(i=e+"."+i)})),r}}().forEach((e=>{var t;e!==i&&(t={name:O,domain:e},w(Object.assign(Object.assign({},t),{value:"",maxAge:0})))})),I(O)>1&&yt.error("More than one tfc-l cookie found after trying to clean up.")}function R(e,t,n){const i=x();i[e]={v:t,e:W()+n},S(i)}function j(e){const t=x()[e];if(t)return t.e<W()?void F(e):t}function A(e){var t;return null===(t=j(e))||void 0===t?void 0:t.v}function F(e){const t=x();delete t[e],S(t)}function W(){return Math.floor((new Date).getTime()/1e3)}const L=e=>e.split("&").reduce(((e,t)=>Object.assign(Object.assign({},e),(([e,t])=>e&&t&&e.startsWith("tfc-")?{[e]:t}:{})(t.split("=")))),{});let N;function C(e=!1){N&&i.scroll(N.scrollX,N.scrollY),e&&(N=void 0)}let U,_=!1,H=null;const P=i.history,z={tfcModalVisible:!0},K=e=>{yt.debug("tfModal - closing TF due to popstate event",e),V("backButton")},M="tfc-viewport";function G(e){if("small"===e&&!r.head.querySelector("#tfc-viewport")){const e=r.createElement("meta");e.setAttribute("id",M),e.setAttribute("name","viewport");const t=_?"width=device-width, initial-scale=1.0, viewport-fit=cover":"width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover";e.setAttribute("content",t),r.head.append(e)}}function D(){const e=r.head.querySelector("#tfc-viewport"),t=[];r.head.querySelectorAll('meta[name="viewport"]').forEach((e=>{e.id!==M&&t.push(e)}));const n=t[0];e&&(e.setAttribute("content",(null==n?void 0:n.getAttribute("content"))||""),r.head.removeChild(e))}function q(){var e;H&&(clearTimeout(H),H=null),(null===(e=P.state)||void 0===e?void 0:e.tfcModalVisible)&&P.back(),i.removeEventListener("popstate",K);const t=r.body;t.classList.remove("tfc-show-modal"),t.classList.remove("tfc-small-screen"),t.classList.remove("tfc-large-screen"),setTimeout((()=>C(!0)),0),D();const n=J();null==n||n.remove()}function B(e){if(!r.getElementById("tfc-full-screen-container")){!function(){const e=r.createElement("style");e.textContent='\n  #tfc-full-screen-container {\n    display: none;\n    position: fixed;\n    overflow-y: auto;\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 100%;\n    z-index: 2147483647;\n    background-color: rgba(0,0,0,0.65)\n  }\n  \n  body.tfc-show-modal #tfc-full-screen-container {\n    display: block;\n  }\n  \n  /* desktop */\n  body.tfc-large-screen #tfc-modal-wrapper {\n    right: 75px;\n    margin-top: 50px;\n    width: 375px;\n    height: 90vh;\n    min-height: 540px;\n    max-height: 765px;\n    border-radius: 15px;\n    position: absolute;\n  }\n  \n  body.tfc-large-screen #tfc-app-iframe {\n    border-radius: 15px;\n  }\n  \n  body #tfc-modal-backlink {\n    position: absolute;\n    right: 15px;\n    font-size: 12px;\n    font-weight: bold;\n    font-family: "Montserrat",sans-serif;\n    color: #ffffff;\n    text-decoration: none;\n  }\n  \n  /* desktop */\n  body.tfc-large-screen #tfc-modal-backlink {\n    bottom: -30px;\n  }\n  \n  /* mobile */\n  body.tfc-small-screen #tfc-modal-backlink {\n    top: -30px;\n  }\n  \n  /* mobile */\n  body.tfc-show-modal.tfc-small-screen {\n    overflow: hidden;\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 100%;\n  }\n  \n  body.tfc-small-screen #tfc-modal-wrapper {\n    position: fixed;\n    left: 0;\n    width: 100%;\n  }\n  \n  body.tfc-small-screen #tfc-modal-wrapper:not(.tfc-partial-height) {\n    top: 0;\n    height: 100%;\n  }\n  \n  body.tfc-small-screen #tfc-modal-wrapper.tfc-partial-height {\n    bottom: 0;\n    height: var(--tfc-partial-modal-height, 90%);\n    max-height: var(--tfc-override-modal-height, unset);\n  }\n  \n  body.tfc-small-screen #tfc-modal-wrapper.tfc-partial-height #tfc-app-iframe {\n    border-top-left-radius: 15px;\n    border-top-right-radius: 15px;\n  }\n  \n  #tfc-app-iframe {\n    width: 100%;\n    height: 100%;\n    border: 0px solid;\n    background-color: #fff\n  }\n  ',r.head.appendChild(e)}();const t=r.createElement("div");t.setAttribute("aria-modal","true"),t.setAttribute("role","dialog"),t.id="tfc-full-screen-container";const n=r.createElement("div");if(n.id="tfc-modal-wrapper",e){const e=r.createElement("a");e.id="tfc-modal-backlink",e.innerHTML="&reg;True Fit",e.setAttribute("href",`https://www.truefit.com/shopper/shoppers-home-page?utm_source=${encodeURIComponent(i.location.hostname)}&utm_campaign=tf_modal`),e.setAttribute("target","_blank"),e.setAttribute("rel","noopener"),n.appendChild(e)}t.appendChild(n),r.body.appendChild(t),t.addEventListener("click",(e=>{e.target instanceof Element&&"tfc-modal-backlink"===e.target.id||V("pageClick")}))}}function J(){const e=r.getElementById("tfc-app-iframe");if(e instanceof HTMLIFrameElement)return e}function V(e){var t;H=i.setTimeout((()=>{H=null,q()}),500);const n=J(),r={type:"requestClose",reason:e};null===(t=null==n?void 0:n.contentWindow)||void 0===t||t.postMessage(r,U)}const X="510px";function Y(e,t){const{mayReprocessWidgets:n=!0}=null!=t?t:{},{widgetToken:o,iframeId:a,iframeOrigin:c,iframePathAndHash:s,mobileModalSize:d,partialModalHeightStyleVal:l}=e,f=$(),u=f||o;if(u){if(u!==f&&(yt.debug("Integration token doesn't match the widget token. Writing widget token to the cookie."),T(u,63072e3),$()!==u))return void yt.error("True Fit cookie isn't persisting - widget should not have rendered. Not opening the app");Ve(u)}if(n&&(!u||f!==o))return yt.debug(u?"Integration token mismatches widget token.":"Latest token is missing.","Reprocessing widgets with an immediate open id."),void qe(a);const p=(e=>{try{return function(e){if(e)try{return JSON.parse(e)}catch(e){console.error("Error parsing json."),console.error(e)}}(localStorage.getItem(e))}catch(e){yt.error("localStorage not supported",e)}})("tfpAppConfigOverrides");var g,h;!function(e,t,n=!1,o){U=e,N={scrollY:i.scrollY,scrollX:i.scrollX},B();let a=J();a&&a.remove();const c=`${e}${t}&originUrl=${encodeURIComponent(r.location.origin)}`;a=r.createElement("iframe"),a.src=c,a.id="tfc-app-iframe";const s=r.getElementById("tfc-modal-wrapper");if(s){t.includes("fitHubResponse")&&s.style.setProperty("--tfc-override-modal-height",X),s.style.setProperty("--tfc-partial-modal-height",null!=o?o:"90%"),s.classList.toggle("tfc-partial-height",n),s.appendChild(a);const e=ie();G(e),r.body.classList.add("tfc-show-modal"),r.body.classList.add(`tfc-${e}-screen`),i.setTimeout((()=>{var e;(null===(e=P.state)||void 0===e?void 0:e.tfcModalVisible)||P.pushState(z,""),i.addEventListener("popstate",K)}))}else yt.error("Unexpected error: #tfc-modal-wrapper element not found")}(c,(g=s,h={token:u,tfpAppConfigOverrides:Object.keys(null!=p?p:{}).length?encodeURIComponent(JSON.stringify({desktop:p,mobile:p})):void 0},Object.entries(null!=h?h:{}).reduce(((e,[t,n])=>!n||e.includes(`${t}=`)?e:`${e}&${t}=${n}`),g)),"Partial"===d,l)}function Z({widgetToken:e,iframeOrigin:t,iframePathAndHash:n}){return Y({iframeOrigin:t,iframePathAndHash:n,widgetToken:e},{mayReprocessWidgets:!1})}let Q=null;const ee=[function(e){var t;"large"===e.newSize&&(C(),D()),G(e.newSize);const n=J(),i="small"===e.newSize?"large":"small";r.body.classList.remove(`tfc-${i}-screen`),r.body.classList.add(`tfc-${e.newSize}-screen`),null===(t=null==n?void 0:n.contentWindow)||void 0===t||t.postMessage(e,U)}];let te=null;const ne=e=>{const t=e.matches?"small":"large";Q=t,ee.forEach((e=>{e({type:"screenSizeChange",newSize:t})}))};function ie(){if(null===Q)throw"ResponsiveManager has not been initialized";return Q}function re(){if(null===Q)throw"ResponsiveManager has not been initialized";const{deviceType:e}=wt();return"responsive"===e?"small"===Q?"mobile":"desktop":e}const oe=new Map,ae=()=>{for(const[e,t]of oe)t.iframe.isConnected||oe.delete(e)};let ce;const se=(e,t)=>e.reduce(((e,n)=>n instanceof HTMLElement?(e.push(n),e):(yt.error(`A ${t} widget was found on an unsupported element:`,n),e)),[]),de=()=>se([...r.querySelectorAll(".tfc-fitrec-register")],"tfc-fitrec-register"),le=()=>se([...r.querySelectorAll(".tfc-fitrec-size-sampling")],"tfc-fitrec-size-sampling"),fe=()=>se([...r.querySelectorAll(".tfc-fitrec-rollup")],"tfc-fitrec-rollup"),ue=()=>se([...r.querySelectorAll(".tfc-order-notify")],"tfc-order-notify"),pe=()=>{const e=se([...r.querySelectorAll(".tfc-fitrec-product")],"tfc-fitrec-product");return e.forEach((e=>{const{dataset:{styleid:t,iframeid:n}}=e;if(!t&&n)for(delete e.dataset.iframeid,oe.delete(n);e&&e.firstChild;)e.removeChild(e.firstChild)})),e},ge=()=>[...pe(),...de(),...ue(),...le()];function he(e){const t=wt(),n=Object.entries((({hash:e,search:t}=r.location)=>Object.assign(Object.assign({},e.startsWith("#")?L(e.slice(1)):{}),t.startsWith("?")?L(t.slice(1)):{}))()).reduce(((e="",[t,n],i)=>`${i?`${e}&`:""}${t.slice(4)}=${n}`),void 0);return Object.assign({tfIntegrationVersion:o.TF_INTEGRATION_UX_VERSION,type:e,retailerHref:i.location.href,retailerOrigin:i.location.origin,deviceType:t.deviceType,screenSize:ie(),integrationPlatform:"web",cookiesEnabled:k(),token:$(),storeKey:t.storeKey,locale:t.locale,userId:t.userId,registered:t.registered,widgetHidden:t.widgetHidden,storeExperimentKey:t.storeExperimentKey},n?{sessionParamOverrides:n}:{})}const me=(e={})=>t=>{const n=Object.assign({colorId:"colorid",configSet:"configset",iframeId:"iframeid",styleId:"styleid",userId:"userid"},e);return t in n?n[t]:t},ye=me(),ve=me({widgetHidden:"widget-hidden",storeExperimentKey:"store-experiment-key"});function be(e,t,n){const i=Math.random().toString(36).substring(2),o=r.createElement("iframe"),{type:a}=e,c=Object.entries(e).reduce(((e,[t,n])=>`${e}${null!=n?`&${t}=${encodeURIComponent(n)}`:""}`),`iframeId=${i}`),{iframeWidgetUrl:s,cdnOrigin:d,widgetHidden:l}=wt();o.src=`${s}#${c}`,o.title="True Fit Widget",t&&(o.dataset.elementId=`widget-iframe-${t}`),o.style.display=l||"api"===a?"none":"block",o.style.height="0",o.style.width="100%",o.style.border="0",n&&(n.dataset.iframeid=i);const f=t?`${a}-${t}`:a;return yt.debug(`added iframe widget to the page for widget ${t} and src ${d}`,performance.now()),oe.set(i,{type:a,iframe:o,loaded:!1,queuedMessages:[]}),o.addEventListener("load",(e=>{const t=oe.get(i);t?(t.queuedMessages.forEach((e=>{tt(t,e,i)})),oe.set(i,Object.assign(Object.assign({},t),{loaded:!0,queuedMessages:[]})),yt.debug(`iframe widget for style ${f} load event`,e,performance.now())):yt.warn(`Iframe id=${i} loaded, but the widget was no longer found.`)})),(n||r.body).appendChild(o),[i,o]}const we=["locale","userId","registered","widgetHidden","storeExperimentKey"],Ee=e=>({locale:e.locale,userId:e.userid,registered:void 0===e.registered?void 0:"true"===e.registered,widgetHidden:void 0===e.widgetHidden?void 0:"true"===e.widgetHidden,storeExperimentKey:e.storeExperimentKey});function Ie(e){const{locale:t,userId:n,widgetHidden:i,storeExperimentKey:r}=e,o={locale:t,userId:n,widgetHidden:i,storeExperimentKey:r};for(const{dataset:e,id:t}of ge()){const n=Ee(e);for(const[i,r]of Object.entries(o)){const o=ye(i),a=n[o];null!=a&&null!=r&&a!==r&&(yt.warn(`Attributes for key "data-${ve(i)}" mismatch. Old=${a} New=${r} WidgetId=${t}. Removing the data attribute from the element.`),delete e[o])}}}function Oe(){const e=ge();for(const t of we){const n=new Set(e.map((e=>e.dataset[ye(t)])));n.size>1&&yt.warn(`Multiple different attribute values detected for data-${ve(t)}: `+Array.from(n).join(", "))}}const Te=({dataset:e})=>{It(Ee(e),!1,!0)},$e=e=>({dataset:{context:t,styleid:n,colorid:i,configset:r,configOverride:o},id:a})=>{const c="tfc-fitrec-rollup"===e?"rollup":t,s=n||a;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({type:e},s?{style:s}:{}),i?{colorId:i}:{}),c?{context:c}:{}),r?{configSet:r}:{}),o?{configOverride:o}:{})},ke=(e,t)=>e.reduce(((e,n)=>n===t?e:[...e,$e("tfc-fitrec-product")(n)]),[]),xe=(e=de())=>e.map($e("tfc-fitrec-register")),Se=(e=fe())=>e.map((e=>$e("tfc-fitrec-rollup")(e))),Re=({element:e,productWidgetEls:t,bannerWidgetEls:n,rollupWidgetEls:i})=>JSON.stringify([...ke(t,e),...xe(n),...Se(i)]);let je;function Ae(){return ae(),je&&!oe.has(je)&&(je=void 0),je}function Fe(){return ae(),oe.keys().next().value}const We=e=>{const t=null==e?void 0:e.dataset.iframeid;return t&&oe.has(t)};function Le({productWidgetEls:e=pe(),bannerWidgetEls:t=de(),rollupWidgetEls:n=fe()}={}){const i=Ae(),r=i&&e.some((e=>e.dataset.iframeid===i))?i:(o=null==(a=e.find(We))?void 0:a.dataset.iframeid,je=o);var o,a;const c=r&&e.find((e=>e.dataset.iframeid===r));if(r&&c)return i!==r&&yt.debug(`ensureRequesterId - Promoting iframe ${r} to requester.`),et(r,{type:"updateOtherWidgets",otherWidgets:Re({element:c,productWidgetEls:e,bannerWidgetEls:t,rollupWidgetEls:n})}),r;yt.trace("ensureRequesterId - No requester iframe found")}function Ne(e){const t=Array.from(oe.keys()),n=[],i=pe(),r=de(),o=fe();Le({bannerWidgetEls:r,productWidgetEls:i,rollupWidgetEls:o}),i.forEach((t=>{var a;const c=t.dataset,s=c.styleid||t.id;if(!s)return void yt.warn("tfc-fitrec-product widget found without a data-styleid attribute - skipping",t);c.styleid||(c.styleid=s),Te(t);const d=wt();if(!c.iframeid)return void function(e,t,n,i,r){const{colorid:o,configset:a,widgetlocation:c,configOverride:s,recOnly:d}=e.dataset,l=e.dataset.context;yt.debug("No data-iframeid found. Creating a product widget iframe...");const f=Ae(),u=n.length+i.length+r.length,p=f&&u>1?null:Re({element:e,productWidgetEls:n,bannerWidgetEls:i,rollupWidgetEls:r}),g=Object.assign(Object.assign(Object.assign({},he("tfc-fitrec-product")),{type:"tfc-fitrec-product",styleId:t,widgetLocation:c,context:l,colorId:o,configSet:a,configOverride:s,recOnly:Ce(d)}),p?{otherWidgets:p}:{}),[h]=be(g,t,e);Ae()||(je=h)}(t,s,i,r,o);const l=null===(a=oe.get(c.iframeid))||void 0===a?void 0:a.iframe;l&&(d.widgetHidden?l.style.display="none":l.style.display="block"),yt.debug("data-iframeid found. Updating variables and refreshing the widget..."),n.push(c.iframeid);const f=Pe(c);Je(c.iframeid,f,!!e&&c.iframeid===e,s)})),t.filter((e=>!n.includes(e))).forEach((e=>{var t;"tfc-fitrec-product"===(null===(t=oe.get(e))||void 0===t?void 0:t.type)&&oe.delete(e)}))}function Ce(e){return void 0===e?void 0:"true"===e}function Ue(){const{userId:e,registered:t,widgetHidden:n,locale:i,storeExperimentKey:r}=wt();return{userId:e,registered:t,locale:i,widgetHidden:n,storeExperimentKey:r}}function _e(e,t){const n=t[ye(e)];if(""!==(null==n?void 0:n.trim()))return n}function He(e,t){return Ce(_e(e,t))}function Pe(e){return Object.assign(Object.assign({},Ue()),{configOverride:_e("configOverride",e),configSet:_e("configSet",e),colorId:_e("colorId",e),recOnly:He("recOnly",e),widgetLocation:_e("widgetlocation",e)})}function ze(){const e=de();e.length&&(e.forEach(Te),function(e){if(Le())return;const t=Fe();t?(et(t,{type:"updateOtherWidgets",otherWidgets:Re({productWidgetEls:[],bannerWidgetEls:e,rollupWidgetEls:[]})}),Je(t,Ue(),!1)):Ye({otherWidgets:JSON.stringify([...xe(e)])})}(e))}function Ke(e){const t=le();t.length&&t.forEach((t=>{const n=t.dataset;if(Te(t),!n.iframeid)return;const i=Pe(n);Je(n.iframeid,i,!!e&&n.iframeid===e)}))}function Me(e){const t=fe();t.length&&t.forEach((t=>{const n=t.dataset,i=n.styleid;if(n.context="rollup",!i)return void yt.warn("tfc-fitrec-rollup widget found without a data-styleid attribute - skipping",t);if(n.styleid||(n.styleid=i),Te(t),!n.iframeid)return void function(e,t){yt.debug("No data-iframeid found. Creating a rollup widget iframe...");const n=pe(),i=de(),r=fe(),o=Ae(),a=n.length+i.length,c=o&&a>1?null:Re({element:e,productWidgetEls:n,bannerWidgetEls:i,rollupWidgetEls:r});be(Object.assign(Object.assign(Object.assign({},he("tfc-fitrec-rollup")),{type:"tfc-fitrec-rollup",styleId:t,widgetLocation:e.dataset.widgetlocation}),c?{otherWidgets:c}:{}),void 0,e)}(t,i);const r=Pe(n);Je(n.iframeid,r,!!e&&n.iframeid===e)}))}function Ge(e={}){const t=ue(),[n,...i]=t;if(!n)return;i.length&&yt.error(`Found ${t.length} tfc-order-notify widgets. Only processing first.`),Te(n);const{orderId:r=n.dataset.orderid}=e;r?Ze({checkoutType:"OrderNotify",orderId:r}):yt.error(new Error("orderId is missing"))}let De=[];function qe(e){Ne(e),Ge(),ze(),Ke(e),Me(e)}function Be(e){const{products:t,orderId:n}=e;t&&(pe().forEach((e=>{const n=e.dataset,i=n.styleid||e.id;if(!i)return;const r=t[i];r&&r.colorId&&(n.colorid=r.colorId)})),Ne()),Ge({orderId:n}),ze(),Ke(),Me()}function Je(e,t,n,i){et(e,Object.assign(Object.assign({type:"widgetRefresh",currentWidget:t},i?{styleIdForCurrentWidget:i}:{}),{immediateOpen:n}))}function Ve(e){Qe({type:"tokenUpdate",token:e})}function Xe(e){const t=wt();["userId","locale","widgetHidden","storeExperimentKey"].forEach((n=>{var i;const r=null!==(i=e[n])&&void 0!==i?i:t[n];void 0!==r&&(e[n]=r)}))}function Ye(e){be(Object.assign(Object.assign(Object.assign({},he("api")),{type:"api"}),e))}function Ze(e){var t;const n=Fe(),i=re(),r=Object.assign(Object.assign({},e),{deviceType:null!==(t=e.deviceType)&&void 0!==t?t:i,integrationPlatform:"web"});Xe(r),n?et(n,{type:"checkout",checkout:r}):Ye({checkout:JSON.stringify(r)})}function Qe(e){oe.forEach(((t,n)=>{et(n,e)}))}function et(e,t){const n=oe.get(e);n?n.loaded?tt(n,t,e):n.queuedMessages.push(t):yt.debug(`Tried to send event ${t.type} but no widget was found.`)}function tt(e,t,n){if(!e.iframe.parentElement)return void yt.error(`Iframe for widget type "${e.type}" with iframeId "${n}" was detached. Not posting message with event type "${t.type}" to the widget.`);const i=e.iframe.contentWindow;null==i||i.postMessage(t,wt().cdnOrigin)}const nt=(e,t=63072e3)=>{T(e,t),Ve(e)};var it=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{s(i.next(e))}catch(e){o(e)}}function c(e){try{s(i.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((i=i.apply(e,t||[])).next())}))};function rt(e){const t=e.headers.get("x-tf-usertoken"),n=e.headers.get("x-tf-usertokenmaxage");t&&n&&nt(t,parseInt(n,10))}function ot(){const{storeKey:e}=wt();return e}function at(){const{cdnOrigin:e}=wt();return o.TF_INTEGRATION_SERVICE_ORIGIN||e}function ct(e,t){return it(this,void 0,void 0,(function*(){return $()||(yield fetch(`${e}/profile/public/v4/${t}/token`,{credentials:"include"}).then((e=>e.json().then((e=>(T(e.token,63072e3),Promise.resolve(e.token)))))))}))}const st=["tfc","dru"];function dt(e,t,n=1){if(n>5){const e=new Error(`Tried to get profile info ${n} times, giving up`);yt.error(e)}else yt.debug(`Trying to get profile info. Attempt #${n}.`),function(e){return it(this,void 0,void 0,(function*(){try{const t=at(),n=ot();if(!st.includes(n))return void yt.error(`Unauthorized store ${n} attempting to get profile info`);const i=yield ct(t,n),r={};r["X-TF-UserToken"]=i;const o=yield fetch(`${t}/profile/public/v4/${n}/profiles/${e}/profile-info`,{headers:r});if(o.ok)return rt(o),yield o.json()}catch(e){yt.error("Error trying to fetch profile info",e)}}))}(e).then((r=>{if(null==r?void 0:r.estimationInProgress)return void i.setTimeout((()=>{dt(e,t,n+1)}),500);yt.debug(`Got profile info after ${n} times.`);const o={typicalSizes:null==r?void 0:r.typicalSizes,department:null==r?void 0:r.department};t(o)})).catch((e=>{yt.error(e)}))}const lt="true"===o.TFP_INTEGRATION_CONSOLE_LOGGER,ft=o.TF_INTEGRATION_LOGGING_LEVEL;function ut(){var e;return null!==(e=i.tfcLoggingLevel)&&void 0!==e?e:c.WARN}ft&&(i.tfcLoggingLevel=c[ft]);let pt=[];function gt(){return e=this,t=void 0,i=function*(){if(pt.length){const e=pt.slice();pt=[],yield function(e){return it(this,void 0,void 0,(function*(){const t=at(),n=ot(),i=yield ct(t,n),r={};r["X-TF-UserToken"]=i,yield fetch(`${t}/profile/public/v4/${n}/client-log`,{headers:Object.assign(Object.assign({},r),{"content-type":"application/json; charset=UTF-8"}),body:JSON.stringify({clientLogs:e}),method:"POST"})}))}(e)}},new((n=void 0)||(n=Promise))((function(r,o){function a(e){try{s(i.next(e))}catch(e){o(e)}}function c(e){try{s(i.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((i=i.apply(e,t||[])).next())}));var e,t,n,i}const ht=function(e,t,n){let i,r,o,a,c=0;n||(n={});const s=function(){c=!1===n.leading?0:b(),i=null,a=e.apply(r,o),i||(r=null,o=[])},d=function(...t){const d=b();c||!1!==n.leading||(c=d);const l=1e3-(d-c);return r=this,o=t,l<=0||l>1e3?(i&&(clearTimeout(i),i=null),c=d,a=e.apply(r,o),i||(r=null,o=[])):i||!1===n.trailing||(i=setTimeout(s,l)),a};return d.cancel=function(){i&&clearTimeout(i),c=0,i=r=null,o=[]},d}(gt,0,{leading:!1});function mt(e,...t){console.error(e,...t);const{stack:n,message:i}=e instanceof Error?e:new Error(`${e}`);pt.push({level:a.ERROR,message:`${i}`,stack:n})}const yt=Object.assign({trace:(e,...t)=>{ut()<=c.TRACE&&console.trace(e,...t)},debug:(e,...t)=>{ut()<=c.DEBUG&&console.debug(e,...t)},info:(e,...t)=>{ut()<=c.INFO&&console.info(e,...t)},warn:(e,...t)=>{ut()<=c.WARN&&(console.warn(e,...t),pt.push({level:a.WARN,message:e}),ht())},warn_consoleOnly:(e,...t)=>{ut()<=c.WARN&&console.warn(e,...t)},error:(e,...t)=>{ut()<=c.ERROR&&(mt(e,...t),ht())},error_consoleOnly:(e,...t)=>{ut()<=c.ERROR&&console.error(e,...t)},raise:(e,...t)=>{const n=new Error(e);throw lt?console.error(n):ut()<=c.ERROR&&(mt(n,...t),gt()),n}},lt?console:{});let vt=null;const bt={locale:!1,userId:!1,registered:!1,widgetHidden:!1,storeExperimentKey:!1};function wt(){if(null===vt)throw"TF integration library needs to be initialized. Use truefit.init.";return vt}function Et(e,t=!0){const{storeKey:n,environment:i="prod",autoCalculate:r=!0,deviceType:a="responsive",locale:c,userId:s,registered:d,widgetHidden:l,storeExperimentKey:f,cookieSameSiteNone:u,channel:p}=e;if(null!==vt)return void yt.error("TF integration library can only be initialized once. Use truefit.update.");t&&Object.entries(e).forEach((([e,t])=>{e in bt&&t&&(bt[e]=!0)}));const g=()=>{let e;const t="https://cdn.truefitcorp.com";return"http"===t.substring(0,4)&&(e=t),o.TF_INTEGRATION_WIDGET_IFRAME_CDN_ORIGIN||e||`https://${n}-cdn.${"prod"!=i?`${i}.`:""}truefitcorp.com`};vt={storeKey:n,environment:i,autoCalculate:r,deviceType:a,locale:c,userId:s,registered:d,widgetHidden:l,storeExperimentKey:f,cdnOrigin:g(),iframeWidgetUrl:o.TF_INTEGRATION_WIDGET_IFRAME_CDN_ORIGIN||`${g()}/tfp-widgets/${(()=>{const e="TFP_WIDGETS_PATH";if("TFP_WIDGETS_"!==e.substring(0,12))return e;if("true"===o.MODULE_BUILD||null!=p){const e=(e=>{switch(e){case"global":return"7.0-localized";case"en-us":return"7.0-stable";case"en-us-latest":return"7.0-latest";default:return void yt.error(`Unsupported channel [${e}] passed to True Fit integration`)}})(p||"global");if(e)return e}return n})()}/index.html`,cookieSameSiteNone:u,channel:p}}function It(e,t=!0,n=!1){if(null===vt)throw"TF integration library needs to be initialized. Use truefit.init.";const i=Object.assign({},vt);["locale","userId","registered","widgetHidden","storeExperimentKey"].forEach((r=>{const o=e[r],a=i[r];void 0!==o&&t&&!n&&(bt[r]=!0,i[r]=o),void 0===o||void 0!==a&&(n||bt[r])||(i[r]=o)})),vt=i}function Ot(e){const t=/\(([^)]*)\)$/;function n(e){const t=e.match(/'([^']*)'/);return t&&t[1]}try{const i=e.split(".").reduce((function(e,i){if(null==e)return;const r=i.match(t);if(!r)return e[i];{const t=e[i.slice(0,-r[0].length)];if("function"==typeof t)return t(...r[1].split(",").map(n))}}),window);if("string"==typeof i)return i}catch(t){yt.error(`Error while trying to get provider ID from window. Path: ${e}`,t)}}class Tt{constructor(){this.callbacks=[]}listen(e){this.callbacks.push(e)}unlisten(e){const t=this.callbacks.indexOf(e);t>=0&&this.callbacks.splice(t,1)}unlistenAll(){this.callbacks.splice(0)}trigger(e){this.callbacks.slice().forEach((t=>t(e)))}}let $t=[];const kt=new Tt,xt=new Tt,St=new Tt,Rt=(e,t,n)=>e.widgetName===t&&e.eventKey===n,jt=(e,t)=>$t.reduce(((n,i)=>Rt(i,e,t)?n+1:n),0);function At(e,t,...n){return wt().widgetHidden?0:($t.forEach((i=>{Rt(i,e,t)&&i.listener(...n)})),jt(e,t))}let Ft=!1;function Wt(e,t=!0){var n,a,c;(null===(n=i.truefit)||void 0===n?void 0:n.initialized)?yt.warn_consoleOnly("True Fit has already been initialized, skipping init. The True Fit integration block was likely added to the page more than once."):(Et(e,t),i.addEventListener("message",(e=>{var t,n,a;yt.debug("tf-integration message received",e);const{cdnOrigin:c,storeKey:s}=wt();if(e.origin===c)switch(e.data.type){case"sizeSamplingBannerDisplay":return void(({isDisplayed:e,iframeId:t})=>{le().forEach((n=>{n.dataset.iframeid===t&&(e?n.setAttribute("data-tf-content-shown","true"):n.removeAttribute("data-tf-content-shown"))}))})(e.data);case"widgetHeight":return void(({height:e,iframeId:t})=>{const n=oe.get(t);if(!n)return void yt.warn("Tried to set widget height, but found no widget.");const i=n.iframe;if(!i.dataset.widgetRendered&&e>0){i.dataset.widgetRendered="true";const e=i.parentElement;for(;e&&e.firstChild&&e.firstChild!==i;)e.removeChild(e.firstChild)}i.style.height=e+"px",yt.debug("Widget rendered at",performance.now())})(e.data);case"widgetWidth":return void(({width:e})=>{pe().forEach((t=>{t.style.maxWidth=e||"100%"}))})(e.data);case"tokenUpdate":return void nt(e.data.token,e.data.maxAge);case"appOpen":return Y(e.data),f=e.data.iframeId,void(ce=f);case"deviceTypeUpdate":return e.data.deviceType&&(function(e){if(null===vt)throw"TF integration library needs to be initialized. Use truefit.init.";vt=Object.assign(Object.assign({},vt),{deviceType:e})}(e.data.deviceType),l=e.data.deviceType,null==te||te.removeEventListener("change",ne),Q="desktop"===l?"large":"small"),void(e.data.fullScreenPopupZoomEnabled&&(d=e.data.fullScreenPopupZoomEnabled,_=d));case"widgetResponse":{const{widgetResponse:i,retailerWidgetResult:a,autoSizeSelect:c,bannerRegistration:d,idSyncProvidersWithFetchers:l,shopperProfileId:f,userState:u,productWidgetLocationConfig:p,rollupWidgetLocationConfig:g}=e.data;B(!1!==(null===(n=null===(t=i.configs)||void 0===t?void 0:t.feature)||void 0===n?void 0:n.backlinkEnabled));const h=(()=>{const e={product:{},rollup:{}};return oe.forEach((t=>{const n=t.iframe.parentNode,i=_e("widgetlocation",n.dataset)||"A",r=_e("styleid",n.dataset),o=n.classList.contains("tfc-fitrec-product")?"product":n.classList.contains("tfc-fitrec-rollup")?"rollup":"";i&&r&&o&&(r in e[o]?e[o][r].add(i):e[o][r]=new Set([i]))})),e})();p&&Object.keys(h.product).forEach((e=>{h.product[e].has(p)||yt.error(`True Fit - A widget location test is running and tried to render location ${p}, but no tfc-fitrec-product element was found with data-widgetlocation="${p}" for style ID ${e}, so the widget is not rendering.`)})),g&&Object.keys(h.rollup).forEach((e=>{h.rollup[e].has(g)||yt.error(`True Fit - A widget location test is running and tried to render location ${g}, but no tfc-fitrec-rollup element was found with data-widgetlocation="${g}" for style ID ${e}, so the widget is not rendering.`)})),yt.debug("Sending widget response to all widgets.",i),Qe({type:"widgetResponse",widgetResponse:i}),u&&xt.trigger(u),a&&At("tfc-fitrec-product","widgetResult",a),c&&c.forEach((e=>{At("tfc-fitrec-product","autoSizeSelect",e)}));const{experiments:m}=i;if(m&&At("tfc-fitrec-product","experiments",m),d&&function(e,t){const n=de();n.length?(De.forEach((e=>e())),De=[],n.forEach((n=>{const i=n.dataset.ageGroup,r=n.dataset.gender,o=n.dataset.category,a=i?`&ageGroup=${i}`:"",c=r?`&gender=${r}`:"",s=o?`&productType=${o}`:"",d=t.iframePathAndHash+a+c+s,l=()=>{ce=void 0,e({widgetToken:t.widgetToken,iframeOrigin:t.iframeOrigin,iframePathAndHash:d})};n.addEventListener("click",l),n.dataset.tfClickHandlerRegistered="true",De.push((()=>{n.removeEventListener("click",l)}))}))):yt.error("Found no banner widgets to add a click handler to.")}(Z,d),f&&kt.trigger(f),l){const e={};let t=!1;for(const n in l){const i=Ot(l[n]);i?(t=!0,e[n]=i):yt.debug(`True Fit - ID sync provider ID for ${n} not found.`)}t&&function(e){const t=Fe();t&&et(t,{type:"idSyncProviderIds",idSyncProviderIds:e})}(e)}if(!Ft&&i.configs.widget["widgets.figEnabled"]){const e=`https://fig${"prod"!==function(){const e=o.TF_INTEGRATION_RUN_MODE;if(e)return e;const t="prod";return t.startsWith("TF_")?"prod":t}()?"-dev":""}.truefitcorp.com/script.js?storeKey=${s}`;yt.info("FIG Enabled, adding script: ",e),function({url:e,isModule:t=!1,removeAfter:n=!1,onSuccess:i,onError:o}){const a=r.createElement("script"),c=r.body;function s(e){return function(){n&&c.removeChild(a),e&&e()}}a.type=t?"module":"text/javascript",a.async=!0,a.src=e,a.onload=s(i),a.onerror=s(o),c.appendChild(a)}({url:e,isModule:!0}),Ft=!0}return}}var d,l,f,u;if(u=e.origin,U&&u===U){if("string"!=typeof e.data)return;const t=JSON.parse(e.data);switch(t.message){case"close":return(null===(a=null==t?void 0:t.data)||void 0===a?void 0:a.redirectUrl)?(yt.info(`True Fit - redirecting to: ${t.data.redirectUrl}`),void(i.location.href=t.data.redirectUrl)):(q(),void function(){var e;ce&&(null===(e=oe.get(ce))||void 0===e||e.iframe.focus(),et(ce,{type:"focusWidgetButton"}))}());case"logout":case"refresh":return void qe();case"usertoken":return void nt(t.data.value,t.data.maxAge);case"open":{const e=function(){var e,t;if(ce)return null===(t=null===(e=oe.get(ce))||void 0===e?void 0:e.iframe.parentElement)||void 0===t?void 0:t.dataset.widgetid}();return void At("tfc-fitrec-register","open",Object.assign(Object.assign({},t.data),e&&{widgetId:e}))}case"profileupdate":return void St.trigger(t.data.profileId);case"modalheightchange":return void function(e){const t=r.getElementById("tfc-modal-wrapper");t?"fitHub"===e.modalHeight?t.style.setProperty("--tfc-override-modal-height",X):t.style.removeProperty("--tfc-override-modal-height"):yt.error("Unexpected error: #tfc-modal-wrapper element not found")}(t.data)}}})),function(){const{deviceType:e}=wt();if("responsive"===e)try{te=i.matchMedia("(max-width: 769px)"),Q=te.matches?"small":"large",te.addEventListener?te.addEventListener("change",ne):te.addListener(ne)}catch(e){yt.error("Error when trying to use matchMedia - falling back to mobile",e),Q="small"}else Q="desktop"===e?"large":"small"}(),a=Qe,ee.push(a),wt().autoCalculate&&(c=()=>qe(),"loading"!==r.readyState?c():r.addEventListener("DOMContentLoaded",c)),i.truefit={initialized:!0})}function Lt(e,t,n){return i=>{if(!(n&&void 0===i||i&&t.some((e=>e===i))))return`${e} should be one of [${t.join(",")}] but found ${i}`}}function Nt(e,t,n=[],i=[]){return(r,o)=>{if(null==r)return void yt.error(`${o} expected type ${e} but was passed ${r}`);const a=[],c=e=>{e&&a.push(e)};if(t.forEach((([e,t])=>{c(function(e,t,n){return"string"==typeof t?function(e,t,n){if(null==e||typeof e!==t)return`${n} is not defined or not a ${t}`}(e,t,n):t(e)}(r[e],t,e))})),n.forEach((([e,t])=>{c(function(e,t,n){return"string"==typeof t?function(e,t,n){if((null==e||typeof e!==t)&&void 0!==e)return`${n} is defined but not a ${t}`}(e,t,n):void 0!==e?t(e):void 0}(r[e],t,e))})),i.forEach((([e,t])=>{c(t(r[e]))})),0===a.length)return r;const s=a.join(", ");yt.error(`${o} expected type ${e} but the passed value had the following errors [${s}]`)}}const Ct=Nt("LineItem",[["productId","string"],["quantity","number"],["price","number"],["currency","string"]],[["colorId","string"],["size","string"],["sku","string"],["salesGroup","string"]]),Ut=(Lt("CheckoutType",["LineItem","OrderNotify"],!1),Lt("DeviceType",["desktop","mobile"],!0)),_t=Lt("IntegrationPlatform",["web","app"],!0),Ht=Lt("Env",["dev","staging","prod"],!0),Pt=Lt("EventKey",["autoSizeSelect","experiments","widgetResult","open"],!1),zt=Nt("SizeSamplingProductInfo",[["styleId","string"],["styleName","string"],["size","string"]]);function Kt(e){if(null!=e&&("object"!=typeof e||e.constructor!==Object||!Object.entries(e).every((([,e])=>void 0!==Jt(e,"products validator")))))return"products are not an optional object where the keys are style IDs and the values are objects with an optional colorId property"}const Mt=Nt("TFCheckout",[["orderId","string"],["products",function(e){if(!(Array.isArray(e)&&e.length>0&&e.every((e=>void 0!==Ct(e,"validateCheckout")))))return"products are not a non-empty list of valid products"}]],[["userId","string"],["locale","string"],["widgetHidden","boolean"],["storeExperimentKey","string"],["deviceType",Ut],["integrationPlatform",_t]]),Gt=Nt("TFTrackSession",[],[["locale","string"],["userId","string"],["widgetHidden","boolean"],["storeExperimentKey","string"],["referrerUri","string"]],[["deviceType",Ut],["integrationPlatform",_t]]),Dt=Nt("TFUpdateWidget",[],[["products",Kt],["orderId","string"],["locale","string"],["userId","string"],["widgetHidden","boolean"],["storeExperimentKey","string"]]),qt=Nt("TFUpdateWidget",[["storeKey","string"]],[["environment",Ht],["autoCalculate","boolean"],["deviceType",Ut]]),Bt=Nt("TFCalculate",[],[["locale","string"],["userId","string"],["registered","boolean"],["widgetHidden","boolean"],["storeExperimentKey","string"],["products",Kt],["orderId","string"]]),Jt=Nt("TFProductUpdate",[],[["colorId","string"]]),Vt=["addtobag","close","complete","logout","pageload","render","update","chat","sizechart","error","success","incompleteprofile","incompletegarment","sizenotavailable","nouser","nostyle","nostylenouser","moreinfo","userdisabled","invaliddepartment","experimentSettings"];function Xt(e){let t;try{t=JSON.stringify(e)}catch(e){return}return t}const Yt={calculate(e){const t=Bt(e||{},"tfcapi-calculate");t?(function(e){const{locale:t,orderId:n,userId:i,registered:r,widgetHidden:o,storeExperimentKey:a,products:c}=e;It({locale:t,userId:i,registered:r,widgetHidden:o,storeExperimentKey:a},!1),n?Be({orderId:n}):c?Be({products:c}):qe()}(t),e?Ie(t):Oe()):yt.error(`tfcapi('calculate', payload) was called without a valid payload: ${e}.`)},init(e){const t=qt(e,"tfcapi-init");(null==t?void 0:t.storeKey)?Wt(t,!1):yt.error("tfcapi('init', payload) was called without a storeKey on the payload")},update(e,t){const n=Dt(t||{},`tfcapi-update-${e}`);n?(Be(n),t?Ie(n):Oe()):yt.error(`tfcapi('update', ${e}, payload) was called without a valid payload: ${t}.`)},track(e,t){if("checkout"===e){const e=Mt(t,"tfcapi-track-checkout");return e?void Ze(Object.assign(Object.assign({},e),{checkoutType:"LineItem"})):void yt.error(`tfcapi('track', 'checkout', payload) was called without a valid payload: ${Xt(t)||t}.`)}if("session"===e){const e=Gt(t||{},"tfcapi-track-session");return e?void function(e){const t=Fe();Xe(e=Object.assign(Object.assign({},e),{deviceType:re(),integrationPlatform:"web",referrerUri:r.referrer,retailerReferer:i.location.href})),t?et(t,{type:"trackSession",sessionInfo:e}):Ye({sessionInfo:JSON.stringify(e)})}(e):void yt.error(`tfcapi('track', 'session', payload) was called without a valid payload: ${Xt(t)||t}.`)}yt.warn(`tfcapi('track', '${e}', payload) called with an unknown tracking type '${e}'.`)},event(e,t,n){const i="tfcapi('event', context, key, handler)";if("string"!=typeof e)return void yt.error(`${i} called with an invalid event context of type ${typeof e}.`,"Valid contexts: tfc-fitrec-product, tfc-fitrec-register");if("tfc-fitrec-product"!==e&&"tfc-fitrec-register"!==e)return void yt.error(`${i} called with an unknown event context "${e}".`,"Valid contexts: tfc-fitrec-product, tfc-fitrec-register");const r=(e=>{const t=Pt(e);if(Vt.includes(e)&&t)yt.error_consoleOnly(t);else{if(!t)return e;yt.error(t)}})(t);r&&(n?"function"==typeof n?function(e,t,n){$t=[...$t,{widgetName:e,eventKey:t,listener:n}],jt(e,t)}(e,r,n):yt.error(`${i} called with a non-function event handler.`):yt.error(`${i} called without an event handler.`))},getToken(e){if("function"!=typeof e)return void yt.error(`tfcapi('getToken', tokenHandler) called with invalid tokenHandler of type '${typeof e}'. Expected a function.`);const[t,n]=function(){const e=j("k");return[null==e?void 0:e.v,e?e.e-W():void 0]}();t&&n||yt.error("Attempted to get the token, but no valid token exists."),e(t,n)},setToken(e,t){"string"==typeof e?void 0===t||"number"==typeof t?nt(e,t):yt.error(`tfcapi('setToken', token, maxAge) called with invalid maxAge of type '${typeof t}'. Expected a number or undefined.`):yt.error(`tfcapi('setToken', token, maxAge) called with invalid token of type '${typeof e}'. Expected a string.`)},listenForUserId(e){"function"==typeof e?kt.listen(e):yt.error(`tfcapi('listenForUserId', userIdHandler) called with invalid userIdHandler of type '${typeof e}' - expected a function.`)},sizeSampling(e){const t=function(e){const t=Array.isArray(e)&&e.length>0;if(Array.isArray(e))return t&&e.every((e=>void 0!==zt(e,"validateSizeSamplingBanner")))?e:void 0;yt.error("productInfo is not an array")}(e);t&&function(e){const t=le(),n=JSON.stringify(e);t.forEach((e=>{if(e.hasAttribute("data-iframeid")){const t=e.getAttribute("data-iframeid");!function(e,t){t&&et(t,{type:"productInfo",productInfo:e})}(n,t)}else be(Object.assign(Object.assign({},he("tfc-fitrec-size-sampling")),{type:"tfc-fitrec-size-sampling",productInfo:n}),"size-sampling-banner",e)}))}(t)},getProductInfo(e,t){if(!e)return void yt.error("tfcapi('getProductInfo', argsObj, handler) called without an arguments object.");if("object"!=typeof e)return void yt.error(`tfcapi('getProductInfo', argsObj, handler) called with invalid argsObj of type '${typeof e}'. Expected an object.`);const{styleId:n,locale:i}=e;"string"==typeof n?void 0===i||"string"==typeof i?"function"==typeof t?function({styleId:e,locale:t}){return it(this,void 0,void 0,(function*(){try{const n=at(),i=ot(),r=yield ct(n,i),o={};o["X-TF-UserToken"]=r;const a=encodeURIComponent(e),c=t?`locale=${encodeURIComponent(t)}`:"",s=yield fetch(`${n}/profile/public/v4/${i}/products/${a}?${c}`,{headers:o});if(s.ok)return yield s.json()}catch(e){yt.error("Error trying to fetch product info",e)}}))}({styleId:n,locale:i}).then(t):yt.error(`tfcapi('getProductInfo', argsObj, handler) called with invalid handler of type '${typeof t}'. Expected a function.`):yt.error(`tfcapi('getProductInfo', argsObj, handler) called with invalid argsObj. Found argsObj.locale of type '${typeof i}'. Expected a string or undefined.`):yt.error(`tfcapi('getProductInfo', argsObj, handler) called with invalid argsObj. Found argsObj.styleId of type '${typeof n}'. Expected a string.`)},listenForUserState(e){"function"==typeof e?xt.listen(e):yt.error(`tfcapi('listenForUserState', userStateHandler) called with invalid userStateHandler of type '${typeof e}' - expected a function.`)},triggerOpen(e){if(!e)return void yt.error("tfcapi('triggerOpen', argsObj) called without an arguments object");if("object"!=typeof e)return void yt.error(`tfcapi('triggerOpen', argsObj) called with invalid argsObj of type '${typeof e}'. Expected an object.`);const{styleId:t}=e;if("string"!=typeof t)return void yt.error(`tfcapi('triggerOpen', argsObj) called with invalid argsObj. Found argsObj.styleId of type '${typeof t}'. Expected a string.`);const n=document.querySelector(`.tfc-fitrec-product[data-styleid="${t}"]`);if(n&&n instanceof HTMLElement){const{iframeid:e}=n.dataset;e?et(e,{type:"triggerOpen"}):yt.error("triggerOpen: tfc-fitrec-product widget isn't rendered yet, unable to open")}else yt.error(`triggerOpen: tfc-fitrec-product widget with data-styleid="${t} not found, unable to open"`)},listenForProfileUpdate(e){"function"==typeof e?St.listen(e):yt.error(`tfcapi('listenForProfileUpdate', profileUpdateHandler) called with invalid profileUpdateHandler of type '${typeof e}' - expected a function.`)},getProfileInfo(e,t){if("function"!=typeof t)return void yt.error(`tfcapi('getProfileInfo', profileInfoArgs, profileInfoHandler) called with invalid profileInfoHandler of type '${typeof t}' - expected a function.`);const{profileId:n}=e;"string"==typeof n?dt(n,t):yt.error(`tfcapi('getProfileInfo', profileInfoArgs, profileInfoHandler) called with invalid argsObj. Found argsObj.profileId of type '${typeof n}'. Expected a string.`)},getProfiles(e){"function"==typeof e?function(){return it(this,void 0,void 0,(function*(){try{const e=at(),t=ot();if(!st.includes(t))return void yt.error(`Unauthorized store ${t} attempting to get profiles`);const n=yield ct(e,t),i={};i["X-TF-UserToken"]=n;const r=yield fetch(`${e}/profile/public/v4/${t}/profiles`,{headers:i});if(r.ok)return rt(r),yield r.json()}catch(e){yt.error("Error trying to fetch profile info",e)}}))}().then(e):yt.error(`tfcapi('getProfiles', profilesHandler) called with invalid profilesHandler of type '${typeof e}' - expected a function.`)}};var Zt;if(function(){var e;if(i.tfcapi&&i.tfcapi.tfIntegrationLoaded)return i.tfcapi;const t=i.tfcapi;i.tfcapi=function(e,...t){if(e in Yt)return Yt[e](...t);yt.error(`tfcapi was called with invalid function name ${e}`)},null===(e=null==t?void 0:t.q)||void 0===e||e.sort(((e,t)=>"init"===e[0]?-1:"init"===t[0]?1:0)).forEach((e=>{i.tfcapi(e[0],e[1],e[2],e[3])})),i.tfcapi.loaded=!0,i.tfcapi.tfIntegrationLoaded=!0,i.tfcapi}(),"true"!==o.MODULE_BUILD&&!(null===(Zt=i.truefit)||void 0===Zt?void 0:Zt.initialized)){const{storeKey:e,environment:t,autoCalculate:n,deviceType:i}=function(){const e={},t=(t,n)=>{const i=e[t];void 0!==i&&i!==n?yt.error(`Mismatched values were passed to the integration block for ${t} using ${i}`):e[t]=n};return[...r.getElementsByTagName("script")].forEach((e=>{const n=e.src.match(/\/fitrec\/([a-z]{3,10})\/js\/(tracker|fitrec)\.js/);if(n){(e.src.split("?",2)[1]||"").split("&").forEach((e=>{const n=e.split("=",2);2===n.length&&t(n[0],n[1])}));const i=n[1];i&&t("storeKey",i);const r=e.src.match(/[a-z]{3,10}-cdn(?:\.(dev|staging))?\.truefitcorp\.com/),o=null==r?void 0:r[1];o&&t("environment",o)}})),e}();e&&Wt({storeKey:e,environment:t,autoCalculate:void 0===n||"true"===n,deviceType:i})}})();