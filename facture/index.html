<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Invoice Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <link rel="stylesheet" href="/facture/style.css">
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <!-- Header -->
    <header class="bg-gray-800/80 backdrop-blur-sm border-b border-gray-700 px-6 py-4">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="p-2 bg-blue-600 rounded-lg">
                    <i data-lucide="file-text" class="w-6 h-6 text-white"></i>
                </div>
                <h1 class="text-2xl font-bold">Professional Invoice Generator</h1>
            </div>
            <div class="flex items-center space-x-4">
                <div class="flex items-center space-x-2">
                    <label class="text-sm text-dark-muted">Theme Color:</label>
                    <input type="color" id="themeColor" value="#3b82f6" 
                           class="w-10 h-10 rounded cursor-pointer border border-gray-600">
                </div>
                <button id="resetBtn" class="px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors">
                    <i data-lucide="refresh-ccw" class="w-4 h-4"></i>
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto p-6">
        <div class="grid lg:grid-cols-2 gap-8">
            <!-- Form Section -->
            <div class="space-y-6">
                <!-- Invoice Settings -->
                <section class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i data-lucide="settings" class="w-5 h-5 mr-2"></i>
                        Invoice Settings
                    </h2>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Language</label>
                            <select id="language" class="form-input">
                                <option value="en">English</option>
                                <option value="de">Deutsch</option>
                                <option value="fr">Français</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Currency</label>
                            <select id="currency" class="form-input">
                                <option value="EUR">EUR (€)</option>
                                <option value="USD">USD ($)</option>
                                <option value="GBP">GBP (£)</option>
                                <option value="CHF">CHF</option>
                                <option value="JPY">JPY (¥)</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Invoice Number *</label>
                            <input type="text" id="invoiceNumber" class="form-input" placeholder="INV-2025-001" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Issue Date *</label>
                            <input type="date" id="issueDate" class="form-input" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Due Date</label>
                            <input type="date" id="dueDate" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Service Period</label>
                            <input type="text" id="servicePeriod" class="form-input" placeholder="2025-01-01 to 2025-01-31">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium mb-2">Reference / PO Number</label>
                            <input type="text" id="reference" class="form-input" placeholder="PO-12345">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium mb-2">Logo</label>
                            <input type="file" id="logoUpload" class="form-input" accept="image/*">
                        </div>
                    </div>
                </section>

                <!-- Vendor Information -->
                <section class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i data-lucide="building" class="w-5 h-5 mr-2"></i>
                        Vendor Information
                    </h2>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Company Name *</label>
                            <input type="text" id="vendorCompany" class="form-input" placeholder="Your Company Ltd." required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Contact Name</label>
                            <input type="text" id="vendorContact" class="form-input" placeholder="John Doe">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium mb-2">Address</label>
                            <textarea id="vendorAddress" class="form-input" rows="3" placeholder="123 Business Street&#10;City, State 12345&#10;Country"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Email</label>
                            <input type="email" id="vendorEmail" class="form-input" placeholder="hello@yourcompany.com">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Phone</label>
                            <input type="tel" id="vendorPhone" class="form-input" placeholder="+1 (555) 123-4567">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium mb-2">VAT Number</label>
                            <input type="text" id="vendorVat" class="form-input" placeholder="VAT123456789">
                        </div>
                    </div>
                </section>

                <!-- Buyer Information -->
                <section class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i data-lucide="user" class="w-5 h-5 mr-2"></i>
                        Buyer Information
                    </h2>
                    <div class="mb-6">
                        <div class="flex items-center justify-center space-x-4">
                            <span id="individualLabel" class="label-active">Individual</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="buyerIsCompany">
                                <span class="toggle-slider"></span>
                            </label>
                            <span id="companyLabel" class="label-inactive">Company</span>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2" id="buyerNameLabel">Name *</label>
                            <input type="text" id="buyerName" class="form-input" placeholder="Client Name" required>
                        </div>
                        <div id="buyerContactDiv" class="hidden">
                            <label class="block text-sm font-medium mb-2">Contact Person</label>
                            <input type="text" id="buyerContact" class="form-input" placeholder="Jane Smith">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium mb-2">Address</label>
                            <textarea id="buyerAddress" class="form-input" rows="3" placeholder="456 Client Avenue&#10;City, State 67890&#10;Country"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Email</label>
                            <input type="email" id="buyerEmail" class="form-input" placeholder="client@example.com">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Phone</label>
                            <input type="tel" id="buyerPhone" class="form-input" placeholder="+1 (555) 987-6543">
                        </div>
                        <div class="md:col-span-2" id="buyerTaxDiv">
                            <label class="block text-sm font-medium mb-2" id="buyerTaxLabel">Tax ID</label>
                            <input type="text" id="buyerTaxId" class="form-input" placeholder="TAX123456789">
                        </div>
                    </div>
                </section>

                <!-- Items Table -->
                <section class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                    <h2 class="text-xl font-semibold mb-4 flex items-center justify-between">
                        <span class="flex items-center">
                            <i data-lucide="shopping-cart" class="w-5 h-5 mr-2"></i>
                            Items
                        </span>
                        <button id="addItemBtn" class="px-3 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors text-sm">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                        </button>
                    </h2>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b border-dark-border">
                                    <th class="text-left py-2 px-1 text-sm font-medium">Description</th>
                                    <th class="text-right py-2 px-1 text-sm font-medium">Unit Price</th>
                                    <th class="text-right py-2 px-1 text-sm font-medium">Qty</th>
                                    <th class="text-right py-2 px-1 text-sm font-medium">Discount</th>
                                    <th class="text-right py-2 px-1 text-sm font-medium">Total</th>
                                    <th class="text-center py-2 px-1 text-sm font-medium w-12"></th>
                                </tr>
                            </thead>
                            <tbody id="itemsTableBody">
                                <!-- Items will be dynamically inserted here -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- VAT Settings -->
                <section class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i data-lucide="percent" class="w-5 h-5 mr-2"></i>
                        VAT / Tax Settings
                    </h2>
                    <div class="space-y-4">
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" id="applyVat" class="form-checkbox">
                            <span>Apply VAT/Tax</span>
                        </label>
                        <div id="vatRateDiv" class="hidden">
                            <label class="block text-sm font-medium mb-2">VAT Rate (%)</label>
                            <input type="number" id="vatRate" class="form-input" min="0" max="100" step="0.1" placeholder="20.0">
                        </div>
                    </div>
                </section>

                <!-- Payment Information -->
                <section class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i data-lucide="credit-card" class="w-5 h-5 mr-2"></i>
                        Payment Information
                    </h2>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">IBAN</label>
                            <input type="text" id="iban" class="form-input" placeholder="DE89 3704 0044 0532 0130 00">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">SWIFT/BIC</label>
                            <input type="text" id="swift" class="form-input" placeholder="COBADEFFXXX">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium mb-2">Payment Link</label>
                            <input type="url" id="paymentLink" class="form-input" placeholder="https://pay.example.com/invoice/123">
                        </div>
                    </div>
                </section>

                <!-- Additional Information -->
                <section class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i data-lucide="file-text" class="w-5 h-5 mr-2"></i>
                        Additional Information
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Remarks</label>
                            <textarea id="remarks" class="form-input" rows="3" placeholder="Additional notes or remarks..."></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Payment Conditions</label>
                            <textarea id="paymentConditions" class="form-input" rows="2" placeholder="Net 14 days. Late fee 5%/month."></textarea>
                        </div>
                    </div>
                </section>

                <!-- Template Management -->
                <section class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i data-lucide="bookmark" class="w-5 h-5 mr-2"></i>
                        Templates & Data
                    </h2>
                    <div class="grid md:grid-cols-2 gap-4">
                        <button id="loadDemoBtn" class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg transition-colors">
                            Load Demo Data
                        </button>
                        <button id="saveTemplateBtn" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors">
                            Save as Template
                        </button>
                        <button id="exportDataBtn" class="px-4 py-2 bg-yellow-600 hover:bg-yellow-700 rounded-lg transition-colors">
                            Export Data
                        </button>
                        <button id="importDataBtn" class="px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-lg transition-colors relative">
                            Import Data
                            <input type="file" id="importFile" class="absolute inset-0 opacity-0 cursor-pointer" accept=".json">
                        </button>
                    </div>
                </section>
            </div>

            <!-- Preview Section -->
            <div class="lg:sticky lg:top-6 h-fit">
                <div class="bg-gray-800 rounded-xl border border-gray-700 overflow-hidden">
                    <div class="p-4 border-b border-gray-700 flex items-center justify-between">
                        <h2 class="text-xl font-semibold flex items-center">
                            <i data-lucide="eye" class="w-5 h-5 mr-2"></i>
                            Live Preview
                        </h2>
                        <div class="flex items-center space-x-2">
                            <button id="zoomOut" class="p-2 hover:bg-gray-700 rounded transition-colors">
                                <i data-lucide="zoom-out" class="w-4 h-4"></i>
                            </button>
                            <span id="zoomLevel" class="text-sm text-gray-400 min-w-12 text-center">100%</span>
                            <button id="zoomIn" class="p-2 hover:bg-gray-700 rounded transition-colors">
                                <i data-lucide="zoom-in" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                    <div id="previewContainer" class="p-6 bg-gray-900 overflow-auto max-h-[80vh]">
                        <div id="pdfPreview" class="transform-gpu transition-transform origin-top-left">
                            <!-- PDF preview will be rendered here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-8 bg-gray-800 rounded-xl p-6 border border-gray-700">
            <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
                    <div>
                        <div class="text-2xl font-bold text-white" id="subtotalDisplay">€0.00</div>
                        <div class="text-sm text-gray-400">Subtotal</div>
                    </div>
                    <div id="discountSection" class="hidden">
                        <div class="text-2xl font-bold text-yellow-500" id="discountDisplay">-€0.00</div>
                        <div class="text-sm text-gray-400">Discount</div>
                    </div>
                    <div id="vatSection" class="hidden">
                        <div class="text-2xl font-bold text-blue-500" id="vatDisplay">€0.00</div>
                        <div class="text-sm text-gray-400">VAT</div>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-green-500" id="totalDisplay">€0.00</div>
                        <div class="text-sm text-gray-400">Total</div>
                    </div>
                </div>
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4">
                    <button id="generatePdfBtn" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors font-medium flex items-center justify-center">
                        <i data-lucide="download" class="w-5 h-5 mr-2"></i>
                        Generate & Download PDF
                    </button>
                    <button id="printBtn" class="px-6 py-3 bg-gray-600 hover:bg-gray-700 rounded-lg transition-colors font-medium flex items-center justify-center">
                        <i data-lucide="printer" class="w-5 h-5 mr-2"></i>
                        Print Preview
                    </button>
                </div>
            </div>
            <div class="mt-4 text-center text-sm text-gray-400">
                Professional Invoice Generator • All data stored locally • No servers required
            </div>
        </footer>
    </main>

    <!-- Modals -->
    <div id="saveTemplateModal" class="modal">
        <div class="bg-gray-800 p-6 rounded-xl border border-gray-700 max-w-md w-full mx-4">
            <h3 class="text-lg font-semibold mb-4">Save Template</h3>
            <input type="text" id="templateName" class="form-input mb-4" placeholder="Template name...">
            <div class="flex justify-end space-x-2">
                <button id="cancelSaveTemplate" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded transition-colors">Cancel</button>
                <button id="confirmSaveTemplate" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded transition-colors">Save</button>
            </div>
        </div>
    </div>

    <div id="loadTemplateModal" class="modal">
        <div class="bg-gray-800 p-6 rounded-xl border border-gray-700 max-w-md w-full mx-4">
            <h3 class="text-lg font-semibold mb-4">Load Template</h3>
            <div id="templatesList" class="space-y-2 mb-4">
                <!-- Templates will be listed here -->
            </div>
            <div class="flex justify-end">
                <button id="cancelLoadTemplate" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded transition-colors">Cancel</button>
            </div>
        </div>
    </div>

    <script src="/facture/app.js"></script>
</body>
</html>